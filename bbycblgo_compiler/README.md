# bbyCOBOL Parser Performance Test

This project provides a Go-based tool for parsing bbyCOBOL files using ANTLR4. It includes functionalities for preprocessing COBOL code, parsing files sequentially or in parallel, and managing failed test cases.

## Files in this Project:

- `main.go`: The main entry point of the application. It handles command-line arguments using Cobra, loads configuration from `config.yaml`, and orchestrates the parsing process. It also includes commands for setting up the ANTLR environment.
- `preprocessing.go`: Contains the `preprocessCobolAdvanced` function, which implements COBOL-specific preprocessing logic to prepare source code for parsing. This includes handling fixed-format rules, continuation lines, and comments.
- `parser.go`: Houses the core ANTLR parsing logic. It defines `ParseResult` and `CustomErrorListener` types, the `parseFileCobol` function for individual file parsing, and `runSequential` and `runParallel` functions for executing tests.
- `config.yaml`: A YAML configuration file that defines various parameters for the application, such as the maximum number of tests to run, directories for test files and failed tests, file extension, and the default run mode (sequential or parallel).
- `bbyCBL.g4`: The ANTLR4 grammar file for bbyCOBOL. This file defines the syntax rules for the COBOL language that the parser will recognize.
- `antlr-4.13.1-complete.jar`: The ANTLR4 runtime JAR file, used for generating the Go parser code from the grammar file. This file is downloaded by the `setup` command.
- `parser/`: This directory will contain the Go parser code generated by ANTLR4 from `bbyCBL.g4`.

## Usage:

To use this tool, you'll typically follow these steps:

1.  **Build the application:**

    ```bash
    go build -o bbycblgo .
    ```

2.  **Setup (Download ANTLR JAR and Generate Parser):**

    ```bash
    ./bbycblgo setup
    ```

3.  **Run tests:**

    *   **Run all tests (parallel by default):**

        ```bash
        ./bbycblgo test
        ```

    *   **Run tests in sequential mode:**

        ```bash
        ./bbycblgo test --runmode sequential
        ```

    *   **Run only previously failed tests:**

        ```bash
        ./bbycblgo failed
        ```

    *   **Clear the failed tests directory:**

        ```bash
        ./bbycblgo clear
        ```

    *   **Override max tests (e.g., run only 100 tests):**

        ```bash
        ./bbycblgo test --maxtest 100
        # or using the alias
        ./bbycblgo test -n 100
        ```

## Configuration:

Edit `config.yaml` to change default parameters:

```yaml
maxtest: 10000
testdir: "../tests/recombined_formatted/"
faileddir: "../tests/failed/"
fileext: ".baby"
runmode: "parallel"
```

Command-line flags will override these values.

## bbyCOBOL Parser (`bbyCBL.g4`):

If you need to modify the bbyCOBOL grammar, edit `bbyCBL.g4` and then run `./bbycblgo setup` again to regenerate the parser code in the `parser/` directory.
